<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <title>RLC Bingo Manager - e-BOS Integration</title>
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <style>
        /* ==================== CSS Variables ==================== */
        :root {
            --primary-color: #1976d2;
            --primary-dark: #1565c0;
            --success-color: #43a047;
            --warning-color: #fb8c00;
            --error-color: #e53935;
            --info-color: #00acc1;
            --text-primary: #212121;
            --text-secondary: #616161;
            --text-disabled: #9e9e9e;
            --border-color: #e0e0e0;
            --background-color: #f5f5f5;
            --card-background: #ffffff;
            --header-height: 60px;
            --nav-height: 60px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background-color);
            min-height: 100vh;
            color: var(--text-primary);
        }
        
        /* ==================== Header ==================== */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .header-title {
            font-size: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .header-info {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 14px;
        }
        
        .session-date {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
        }
        
        /* ==================== Main Content ==================== */
        .main-content {
            padding-top: var(--header-height);
            padding-bottom: var(--nav-height);
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* ==================== Progress Indicator ==================== */
        .progress-bar {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
        }
        
        .progress-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--border-color);
            z-index: 0;
        }
        
        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
            flex: 1;
        }
        
        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .step.active .step-circle {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }
        
        .step.completed .step-circle {
            background: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }
        
        .step-label {
            font-size: 12px;
            text-align: center;
            color: var(--text-secondary);
        }
        
        .step.active .step-label {
            color: var(--primary-color);
            font-weight: 600;
        }
        
        /* ==================== Form Sections ==================== */
        .form-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--background-color);
        }
        
        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
        }
        
        /* ==================== Door Sales Entry Grid ==================== */
        .door-sales-grid {
            display: grid;
            gap: 20px;
        }
        
        .sales-category {
            background: var(--background-color);
            border-radius: 8px;
            padding: 15px;
        }
        
        .category-header {
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 12px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .sales-items {
            display: grid;
            gap: 12px;
        }
        
        .sales-item {
            display: grid;
            grid-template-columns: 1fr 100px 100px;
            gap: 10px;
            align-items: center;
            background: white;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }
        
        .item-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .item-price {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 2px;
        }
        
        .quantity-input {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            text-align: center;
            background: white;
        }
        
        .quantity-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.1);
        }
        
        .item-total {
            text-align: right;
            font-weight: 600;
            color: var(--success-color);
            font-size: 14px;
        }
        
        /* ==================== Pull Tab Entry ==================== */
        .pulltab-games-list {
            display: grid;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .pulltab-game-entry {
            background: var(--background-color);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid var(--border-color);
        }
        
        .pulltab-game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .game-selector {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            background: white;
            margin-bottom: 12px;
        }
        
        .game-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            font-size: 13px;
        }
        
        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px dotted var(--border-color);
        }
        
        .detail-label {
            color: var(--text-secondary);
        }
        
        .detail-value {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        /* ==================== Photo Capture ==================== */
        .photo-capture-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .photo-item {
            position: relative;
            background: var(--background-color);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            border: 2px dashed var(--border-color);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .photo-item:hover {
            border-color: var(--primary-color);
            background: rgba(25, 118, 210, 0.05);
        }
        
        .photo-item.captured {
            border-style: solid;
            border-color: var(--success-color);
            background: rgba(67, 160, 71, 0.05);
        }
        
        .photo-icon {
            font-size: 48px;
            color: var(--text-disabled);
            margin-bottom: 8px;
        }
        
        .photo-item.captured .photo-icon {
            color: var(--success-color);
        }
        
        .photo-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }
        
        .photo-status {
            font-size: 10px;
            color: var(--text-disabled);
        }
        
        .photo-item.captured .photo-status {
            color: var(--success-color);
        }
        
        /* ==================== Totals Summary ==================== */
        .totals-summary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .totals-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .total-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .total-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .total-value {
            font-size: 16px;
            font-weight: 600;
        }
        
        .grand-total {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            padding-top: 15px;
            border-top: 2px solid rgba(255,255,255,0.3);
        }
        
        /* ==================== Buttons ==================== */
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .btn-success {
            background: var(--success-color);
            color: white;
        }
        
        .btn-secondary {
            background: var(--text-secondary);
            color: white;
        }
        
        .btn-outline {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }
        
        .btn-full-width {
            width: 100%;
            justify-content: center;
        }
        
        /* ==================== Bottom Navigation ==================== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--nav-height);
            background: white;
            box-shadow: 0 -2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
        }
        
        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: color 0.2s;
        }
        
        .nav-item.active {
            color: var(--primary-color);
        }
        
        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }
        
        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }
        
        /* ==================== Monday Check ==================== */
        .day-restriction-notice {
            background: var(--warning-color);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        /* ==================== Loading States ==================== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            display: none;
        }
        
        .loading-overlay.active {
            display: flex;
        }
        
        .loading-card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border-color);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ==================== Responsive ==================== */
        @media (max-width: 600px) {
            .sales-item {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .item-total {
                text-align: left;
                padding-top: 8px;
                border-top: 1px solid var(--border-color);
            }
            
            .photo-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-title">
            <span>ü¶Å</span>
            <span>RLC Bingo Manager</span>
        </div>
        <div class="header-info">
            <div class="session-date" id="sessionDate">Monday, Nov 4, 2024</div>
            <span id="userName">Closet Worker</span>
        </div>
    </header>
    
    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <!-- Monday Check Notice -->
            <div class="day-restriction-notice" id="dayNotice" style="display:none;">
                <strong>‚ö†Ô∏è Data entry is only available on Mondays</strong><br>
                Next Monday: <span id="nextMonday"></span>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress-bar">
                <div class="progress-steps">
                    <div class="step active" id="step1">
                        <div class="step-circle">1</div>
                        <div class="step-label">Door Sales</div>
                    </div>
                    <div class="step" id="step2">
                        <div class="step-circle">2</div>
                        <div class="step-label">Pull Tabs</div>
                    </div>
                    <div class="step" id="step3">
                        <div class="step-circle">3</div>
                        <div class="step-label">Photos</div>
                    </div>
                    <div class="step" id="step4">
                        <div class="step-circle">4</div>
                        <div class="step-label">Review</div>
                    </div>
                </div>
            </div>
            
            <!-- Step 1: Door Sales Entry -->
            <div id="doorSalesStep" class="form-section">
                <div class="section-header">
                    <div>
                        <div class="section-title">
                            <span class="material-icons">point_of_sale</span>
                            Door Sales Summary Entry
                        </div>
                        <div class="section-subtitle">Enter quantities from e-BOS Door Sales Summary printout</div>
                    </div>
                </div>
                
                <div class="door-sales-grid">
                    <!-- Electronic Bingo -->
                    <div class="sales-category">
                        <div class="category-header">Electronic Bingo</div>
                        <div class="sales-items">
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">27reg18pro - Small</div>
                                    <div class="item-price">$40.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="elec27_40" min="0" value="0" data-price="40">
                                <div class="item-total">$0.00</div>
                            </div>
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">45reg36pro - Large</div>
                                    <div class="item-price">$65.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="elec45_65" min="0" value="0" data-price="65">
                                <div class="item-total">$0.00</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Paper Products -->
                    <div class="sales-category">
                        <div class="category-header">Paper Products</div>
                        <div class="sales-items">
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">6 Face</div>
                                    <div class="item-price">$10.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="paper6Face" min="0" value="0" data-price="10">
                                <div class="item-total">$0.00</div>
                            </div>
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">9 Face Solid</div>
                                    <div class="item-price">$15.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="paper9Solid" min="0" value="0" data-price="15">
                                <div class="item-total">$0.00</div>
                            </div>
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">9 Face Stripe</div>
                                    <div class="item-price">$10.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="paper9Stripe" min="0" value="0" data-price="10">
                                <div class="item-total">$0.00</div>
                            </div>
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">Birthday Pack (BOGO)</div>
                                    <div class="item-price">$0.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="paperBirthday" min="0" value="0" data-price="0">
                                <div class="item-total">$0.00</div>
                            </div>
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">Early Bird Double</div>
                                    <div class="item-price">$5.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="paperEarlyBird" min="0" value="0" data-price="5">
                                <div class="item-total">$0.00</div>
                            </div>
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">Progressive 18 Face</div>
                                    <div class="item-price">$5.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="paperProg18" min="0" value="0" data-price="5">
                                <div class="item-total">$0.00</div>
                            </div>
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">Progressive 3 Face</div>
                                    <div class="item-price">$1.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="paperProg3" min="0" value="0" data-price="1">
                                <div class="item-total">$0.00</div>
                            </div>
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">Coverall Extra ($500)</div>
                                    <div class="item-price">$1.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="paperCoverall" min="0" value="0" data-price="1">
                                <div class="item-total">$0.00</div>
                            </div>
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">Letter X Extra ($250)</div>
                                    <div class="item-price">$1.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="paperLetterX" min="0" value="0" data-price="1">
                                <div class="item-total">$0.00</div>
                            </div>
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">Number 7 Extra ($250)</div>
                                    <div class="item-price">$1.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="paperNumber7" min="0" value="0" data-price="1">
                                <div class="item-total">$0.00</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Miscellaneous -->
                    <div class="sales-category">
                        <div class="category-header">Miscellaneous</div>
                        <div class="sales-items">
                            <div class="sales-item">
                                <div>
                                    <div class="item-name">Daubers</div>
                                    <div class="item-price">$2.00 each</div>
                                </div>
                                <input type="number" class="quantity-input" id="miscDaubers" min="0" value="0" data-price="2">
                                <div class="item-total">$0.00</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Totals Summary -->
                <div class="totals-summary">
                    <div class="totals-grid">
                        <div class="total-item">
                            <span class="total-label">Electronic Total</span>
                            <span class="total-value" id="electronicTotal">$0.00</span>
                        </div>
                        <div class="total-item">
                            <span class="total-label">Paper Total</span>
                            <span class="total-value" id="paperTotal">$0.00</span>
                        </div>
                        <div class="total-item">
                            <span class="total-label">Misc Total</span>
                            <span class="total-value" id="miscTotal">$0.00</span>
                        </div>
                        <div class="total-item">
                            <span class="total-label">Total Players</span>
                            <span class="total-value">
                                <input type="number" id="totalPlayers" style="width:60px; background:white; color:var(--primary-color); border:1px solid white; padding:4px; text-align:center; border-radius:4px;" min="0" value="0">
                            </span>
                        </div>
                    </div>
                    <div class="grand-total" id="grandTotal">
                        GRAND TOTAL: $0.00
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary btn-full-width" onclick="nextStep()">
                        Continue to Pull Tabs
                        <span class="material-icons">arrow_forward</span>
                    </button>
                </div>
            </div>
            
            <!-- Step 2: Pull Tab Entry -->
            <div id="pullTabStep" class="form-section" style="display:none;">
                <div class="section-header">
                    <div>
                        <div class="section-title">
                            <span class="material-icons">confirmation_number</span>
                            Pull Tab Nightly Summary
                        </div>
                        <div class="section-subtitle">Record all event pull tab games played</div>
                    </div>
                </div>
                
                <div class="pulltab-games-list" id="pullTabGamesList">
                    <!-- Games will be added dynamically -->
                </div>
                
                <button class="btn btn-outline btn-full-width" onclick="addPullTabGame()">
                    <span class="material-icons">add</span>
                    Add Another Game
                </button>
                
                <div class="totals-summary" style="margin-top:20px;">
                    <div class="totals-grid">
                        <div class="total-item">
                            <span class="total-label">Total Gross Sales</span>
                            <span class="total-value" id="pullTabGross">$0.00</span>
                        </div>
                        <div class="total-item">
                            <span class="total-label">Total Prizes Paid</span>
                            <span class="total-value" id="pullTabPrizes">$0.00</span>
                        </div>
                        <div class="total-item">
                            <span class="total-label">Actual Profit</span>
                            <span class="total-value" id="pullTabActual">$0.00</span>
                        </div>
                        <div class="total-item">
                            <span class="total-label">Ideal Profit</span>
                            <span class="total-value" id="pullTabIdeal">$0.00</span>
                        </div>
                    </div>
                    <div style="margin-top:15px; padding-top:15px; border-top:1px solid rgba(255,255,255,0.3);">
                        <div class="total-item">
                            <span class="total-label">Cash Turn In Amount</span>
                            <span class="total-value">
                                <input type="number" id="cashTurnIn" style="width:100px; background:white; color:var(--primary-color); border:1px solid white; padding:4px; text-align:center; border-radius:4px;" min="0" step="0.01" value="0.00">
                            </span>
                        </div>
                        <div class="total-item">
                            <span class="total-label">Variance (Offage)</span>
                            <span class="total-value" id="pullTabVariance">$0.00</span>
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">
                        <span class="material-icons">arrow_back</span>
                        Back
                    </button>
                    <button class="btn btn-primary" onclick="nextStep()">
                        Continue to Photos
                        <span class="material-icons">arrow_forward</span>
                    </button>
                </div>
            </div>
            
            <!-- Step 3: Photo Capture -->
            <div id="photoStep" class="form-section" style="display:none;">
                <div class="section-header">
                    <div>
                        <div class="section-title">
                            <span class="material-icons">camera_alt</span>
                            Document Photos
                        </div>
                        <div class="section-subtitle">Capture photos of all completed paper forms</div>
                    </div>
                </div>
                
                <div class="photo-grid">
                    <div class="photo-item" onclick="capturePhoto('gamesSheet')">
                        <span class="material-icons photo-icon">description</span>
                        <div class="photo-label">Bingo Games Sheet</div>
                        <div class="photo-status">Tap to capture</div>
                        <input type="file" id="photo-gamesSheet" accept="image/*" capture="environment" style="display:none;">
                    </div>
                    
                    <div class="photo-item" onclick="capturePhoto('occasionReport')">
                        <span class="material-icons photo-icon">assignment</span>
                        <div class="photo-label">Occasion Report</div>
                        <div class="photo-status">Tap to capture</div>
                        <input type="file" id="photo-occasionReport" accept="image/*" capture="environment" style="display:none;">
                    </div>
                    
                    <div class="photo-item" onclick="capturePhoto('moneySummary')">
                        <span class="material-icons photo-icon">attach_money</span>
                        <div class="photo-label">Money Summary</div>
                        <div class="photo-status">Tap to capture</div>
                        <input type="file" id="photo-moneySummary" accept="image/*" capture="environment" style="display:none;">
                    </div>
                    
                    <div class="photo-item" onclick="capturePhoto('pullTabSummary')">
                        <span class="material-icons photo-icon">confirmation_number</span>
                        <div class="photo-label">Pull Tab Summary</div>
                        <div class="photo-status">Tap to capture</div>
                        <input type="file" id="photo-pullTabSummary" accept="image/*" capture="environment" style="display:none;">
                    </div>
                    
                    <div class="photo-item" onclick="capturePhoto('depositSlip')">
                        <span class="material-icons photo-icon">receipt</span>
                        <div class="photo-label">Deposit Slip</div>
                        <div class="photo-status">Tap to capture</div>
                        <input type="file" id="photo-depositSlip" accept="image/*" capture="environment" style="display:none;">
                    </div>
                    
                    <div class="photo-item" onclick="capturePhoto('doorSalesPrint')">
                        <span class="material-icons photo-icon">print</span>
                        <div class="photo-label">Door Sales Printout</div>
                        <div class="photo-status">Tap to capture</div>
                        <input type="file" id="photo-doorSalesPrint" accept="image/*" capture="environment" style="display:none;">
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">
                        <span class="material-icons">arrow_back</span>
                        Back
                    </button>
                    <button class="btn btn-primary" onclick="nextStep()">
                        Review & Submit
                        <span class="material-icons">arrow_forward</span>
                    </button>
                </div>
            </div>
            
            <!-- Step 4: Review & Submit -->
            <div id="reviewStep" class="form-section" style="display:none;">
                <div class="section-header">
                    <div>
                        <div class="section-title">
                            <span class="material-icons">fact_check</span>
                            Review & Submit
                        </div>
                        <div class="section-subtitle">Verify all information before submitting</div>
                    </div>
                </div>
                
                <div id="reviewContent">
                    <!-- Review content will be generated dynamically -->
                </div>
                
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">
                        <span class="material-icons">arrow_back</span>
                        Back
                    </button>
                    <button class="btn btn-success btn-full-width" onclick="submitOccasion()">
                        <span class="material-icons">check_circle</span>
                        Submit Occasion Report
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item active">
            <span class="material-icons nav-icon">input</span>
            <span class="nav-label">Entry</span>
        </div>
        <div class="nav-item">
            <span class="material-icons nav-icon">history</span>
            <span class="nav-label">History</span>
        </div>
        <div class="nav-item">
            <span class="material-icons nav-icon">help</span>
            <span class="nav-label">Help</span>
        </div>
    </nav>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-card">
            <div class="spinner"></div>
            <div id="loadingText">Processing...</div>
        </div>
    </div>
    
    <script>
        // ============================================
        // CONFIGURATION & PRICING
        // ============================================
        const PRICING = {
            electronic: {
                'elec27_40': { name: '27reg18pro - Small', price: 40 },
                'elec45_65': { name: '45reg36pro - Large', price: 65 }
            },
            paper: {
                'paper6Face': { name: '6 Face', price: 10 },
                'paper9Solid': { name: '9 Face Solid', price: 15 },
                'paper9Stripe': { name: '9 Face Stripe', price: 10 },
                'paperBirthday': { name: 'Birthday Pack', price: 0 },
                'paperEarlyBird': { name: 'Early Bird Double', price: 5 },
                'paperProg18': { name: 'Progressive 18 Face', price: 5 },
                'paperProg3': { name: 'Progressive 3 Face', price: 1 },
                'paperCoverall': { name: 'Coverall Extra', price: 1 },
                'paperLetterX': { name: 'Letter X Extra', price: 1 },
                'paperNumber7': { name: 'Number 7 Extra', price: 1 }
            },
            misc: {
                'miscDaubers': { name: 'Daubers', price: 2 }
            }
        };
        
        // Pull Tab Games Library (from catalog)
        const PULLTAB_GAMES = [
            { id: 'PT001', name: 'Race Horse Downs 250', formNumber: '354GA', ticketCount: 1000, pricePerTicket: 1, totalPayout: 670, idealProfit: 330, profitPercent: 33 },
            { id: 'PT002', name: 'Race Horse Downs 500', formNumber: '353GA', ticketCount: 2040, pricePerTicket: 1, totalPayout: 1425, idealProfit: 615, profitPercent: 30 },
            { id: 'PT003', name: 'Pot of Gold 280', formNumber: '7320D', ticketCount: 440, pricePerTicket: 1, totalPayout: 280, idealProfit: 160, profitPercent: 36 },
            { id: 'PT004', name: 'Pot of Gold 400', formNumber: '7321D', ticketCount: 660, pricePerTicket: 1, totalPayout: 400, idealProfit: 260, profitPercent: 39 },
            { id: 'PT005', name: 'Patriot 599', formNumber: '5340W', ticketCount: 840, pricePerTicket: 1, totalPayout: 599, idealProfit: 241, profitPercent: 29 },
            { id: 'PT006', name: 'Life Happens 599', formNumber: '7726H', ticketCount: 960, pricePerTicket: 1, totalPayout: 599, idealProfit: 361, profitPercent: 38 },
            { id: 'CUSTOM', name: 'Add New Game...', formNumber: '', ticketCount: 0, pricePerTicket: 0, totalPayout: 0, idealProfit: 0, profitPercent: 0 }
        ];
        
        // ============================================
        // STATE MANAGEMENT
        // ============================================
        let currentStep = 1;
        let occasionData = {
            date: new Date().toISOString().split('T')[0],
            doorSales: {},
            pullTabs: [],
            photos: {},
            totals: {
                electronic: 0,
                paper: 0,
                misc: 0,
                grand: 0,
                players: 0
            }
        };
        
        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            checkMondayRestriction();
            setupEventListeners();
            updateSessionDate();
            addPullTabGame(); // Add first pull tab entry
        });
        
        function checkMondayRestriction() {
            const today = new Date();
            const dayOfWeek = today.getDay();
            
            // Check if today is Monday (1)
            if (dayOfWeek !== 1) {
                // Calculate next Monday
                const daysUntilMonday = (8 - dayOfWeek) % 7 || 7;
                const nextMonday = new Date(today);
                nextMonday.setDate(today.getDate() + daysUntilMonday);
                
                document.getElementById('dayNotice').style.display = 'block';
                document.getElementById('nextMonday').textContent = nextMonday.toLocaleDateString('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                // Disable all inputs if not Monday
                document.querySelectorAll('input, select, button').forEach(el => {
                    el.disabled = true;
                });
            }
        }
        
        function updateSessionDate() {
            const today = new Date();
            document.getElementById('sessionDate').textContent = today.toLocaleDateString('en-US', {
                weekday: 'short',
                month: 'short',
                day: 'numeric',
                year: 'numeric'
            });
        }
        
        function setupEventListeners() {
            // Add listeners to all quantity inputs for real-time calculation
            document.querySelectorAll('.quantity-input').forEach(input => {
                input.addEventListener('input', calculateTotals);
            });
            
            // Cash turn-in listener
            document.getElementById('cashTurnIn').addEventListener('input', calculatePullTabVariance);
        }
        
        // ============================================
        // CALCULATION FUNCTIONS
        // ============================================
        function calculateTotals() {
            let electronicTotal = 0;
            let paperTotal = 0;
            let miscTotal = 0;
            
            // Calculate each category
            document.querySelectorAll('.quantity-input').forEach(input => {
                const quantity = parseInt(input.value) || 0;
                const price = parseFloat(input.dataset.price) || 0;
                const total = quantity * price;
                
                // Update individual item total
                const totalElement = input.closest('.sales-item').querySelector('.item-total');
                if (totalElement) {
                    totalElement.textContent = `$${total.toFixed(2)}`;
                }
                
                // Add to category totals
                const inputId = input.id;
                if (inputId.startsWith('elec')) {
                    electronicTotal += total;
                } else if (inputId.startsWith('paper')) {
                    paperTotal += total;
                } else if (inputId.startsWith('misc')) {
                    miscTotal += total;
                }
                
                // Store in data
                occasionData.doorSales[inputId] = {
                    quantity: quantity,
                    price: price,
                    total: total
                };
            });
            
            const grandTotal = electronicTotal + paperTotal + miscTotal;
            
            // Update displays
            document.getElementById('electronicTotal').textContent = `$${electronicTotal.toFixed(2)}`;
            document.getElementById('paperTotal').textContent = `$${paperTotal.toFixed(2)}`;
            document.getElementById('miscTotal').textContent = `$${miscTotal.toFixed(2)}`;
            document.getElementById('grandTotal').textContent = `GRAND TOTAL: $${grandTotal.toFixed(2)}`;
            
            // Update occasion data
            occasionData.totals.electronic = electronicTotal;
            occasionData.totals.paper = paperTotal;
            occasionData.totals.misc = miscTotal;
            occasionData.totals.grand = grandTotal;
            occasionData.totals.players = parseInt(document.getElementById('totalPlayers').value) || 0;
        }
        
        // ============================================
        // PULL TAB FUNCTIONS
        // ============================================
        let pullTabGameCount = 0;
        
        function addPullTabGame() {
            pullTabGameCount++;
            const gameId = `game_${pullTabGameCount}`;
            
            const gameHtml = `
                <div class="pulltab-game-entry" id="${gameId}">
                    <div class="pulltab-game-header">
                        <strong>Game #${pullTabGameCount}</strong>
                        ${pullTabGameCount > 1 ? `<button class="btn btn-secondary" onclick="removePullTabGame('${gameId}')">Remove</button>` : ''}
                    </div>
                    
                    <select class="game-selector" onchange="selectPullTabGame('${gameId}', this.value)">
                        <option value="">Select a game...</option>
                        ${PULLTAB_GAMES.map(game => 
                            `<option value="${game.id}">${game.name}</option>`
                        ).join('')}
                    </select>
                    
                    <div class="game-details" id="${gameId}_details" style="display:none;">
                        <!-- Details will be populated when game is selected -->
                    </div>
                </div>
            `;
            
            document.getElementById('pullTabGamesList').insertAdjacentHTML('beforeend', gameHtml);
        }
        
        function selectPullTabGame(gameId, selectedGameId) {
            if (!selectedGameId) {
                document.getElementById(`${gameId}_details`).style.display = 'none';
                return;
            }
            
            const game = PULLTAB_GAMES.find(g => g.id === selectedGameId);
            if (!game) return;
            
            if (selectedGameId === 'CUSTOM') {
                // Show custom game entry wizard
                showCustomGameWizard(gameId);
                return;
            }
            
            // Display game details
            const detailsHtml = `
                <div class="detail-item">
                    <span class="detail-label">Ticket Count:</span>
                    <span class="detail-value">${game.ticketCount}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Price per Ticket:</span>
                    <span class="detail-value">$${game.pricePerTicket}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Gross Sales:</span>
                    <span class="detail-value">$${(game.ticketCount * game.pricePerTicket).toFixed(2)}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Prizes Paid:</span>
                    <span class="detail-value">
                        <input type="number" id="${gameId}_prizes" value="${game.totalPayout}" 
                               style="width:80px; padding:4px; border:1px solid var(--border-color); border-radius:4px;"
                               onchange="calculatePullTabTotals()">
                    </span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Ideal Profit:</span>
                    <span class="detail-value">$${game.idealProfit} (${game.profitPercent}%)</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Serial Number:</span>
                    <span class="detail-value">
                        <input type="text" id="${gameId}_serial" placeholder="Enter serial #" 
                               style="width:120px; padding:4px; border:1px solid var(--border-color); border-radius:4px;">
                    </span>
                </div>
            `;
            
            document.getElementById(`${gameId}_details`).innerHTML = detailsHtml;
            document.getElementById(`${gameId}_details`).style.display = 'block';
            
            // Store game data
            occasionData.pullTabs[gameId] = {
                gameId: game.id,
                gameName: game.name,
                formNumber: game.formNumber,
                ticketCount: game.ticketCount,
                pricePerTicket: game.pricePerTicket,
                grossSales: game.ticketCount * game.pricePerTicket,
                prizesPaid: game.totalPayout,
                idealProfit: game.idealProfit,
                profitPercent: game.profitPercent
            };
            
            calculatePullTabTotals();
        }
        
        function calculatePullTabTotals() {
            let totalGross = 0;
            let totalPrizes = 0;
            let totalIdeal = 0;
            
            Object.values(occasionData.pullTabs).forEach(game => {
                if (game) {
                    totalGross += game.grossSales || 0;
                    totalPrizes += game.prizesPaid || 0;
                    totalIdeal += game.idealProfit || 0;
                }
            });
            
            const actualProfit = totalGross - totalPrizes;
            
            document.getElementById('pullTabGross').textContent = `$${totalGross.toFixed(2)}`;
            document.getElementById('pullTabPrizes').textContent = `$${totalPrizes.toFixed(2)}`;
            document.getElementById('pullTabActual').textContent = `$${actualProfit.toFixed(2)}`;
            document.getElementById('pullTabIdeal').textContent = `$${totalIdeal.toFixed(2)}`;
            
            calculatePullTabVariance();
        }
        
        function calculatePullTabVariance() {
            const cashTurnIn = parseFloat(document.getElementById('cashTurnIn').value) || 0;
            const actualProfit = parseFloat(document.getElementById('pullTabActual').textContent.replace('$', '')) || 0;
            const variance = cashTurnIn - actualProfit;
            
            document.getElementById('pullTabVariance').textContent = variance >= 0 ? 
                `+$${Math.abs(variance).toFixed(2)}` : 
                `-$${Math.abs(variance).toFixed(2)}`;
        }
        
        function removePullTabGame(gameId) {
            document.getElementById(gameId).remove();
            delete occasionData.pullTabs[gameId];
            calculatePullTabTotals();
        }
        
        // ============================================
        // PHOTO CAPTURE
        // ============================================
        function capturePhoto(photoType) {
            document.getElementById(`photo-${photoType}`).click();
            
            document.getElementById(`photo-${photoType}`).onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    // Mark as captured
                    const photoItem = e.target.closest('.photo-item');
                    photoItem.classList.add('captured');
                    photoItem.querySelector('.photo-status').textContent = 'Captured ‚úì';
                    
                    // Store photo data
                    occasionData.photos[photoType] = file;
                    
                    // Could add preview functionality here
                }
            };
        }
        
        // ============================================
        // NAVIGATION
        // ============================================
        function nextStep() {
            if (currentStep < 4) {
                // Hide current step
                document.getElementById(getStepId(currentStep)).style.display = 'none';
                document.getElementById(`step${currentStep}`).classList.remove('active');
                document.getElementById(`step${currentStep}`).classList.add('completed');
                
                // Show next step
                currentStep++;
                document.getElementById(getStepId(currentStep)).style.display = 'block';
                document.getElementById(`step${currentStep}`).classList.add('active');
                
                // Generate review if on last step
                if (currentStep === 4) {
                    generateReview();
                }
            }
        }
        
        function previousStep() {
            if (currentStep > 1) {
                // Hide current step
                document.getElementById(getStepId(currentStep)).style.display = 'none';
                document.getElementById(`step${currentStep}`).classList.remove('active');
                
                // Show previous step
                currentStep--;
                document.getElementById(getStepId(currentStep)).style.display = 'block';
                document.getElementById(`step${currentStep}`).classList.remove('completed');
                document.getElementById(`step${currentStep}`).classList.add('active');
            }
        }
        
        function getStepId(step) {
            const stepIds = {
                1: 'doorSalesStep',
                2: 'pullTabStep',
                3: 'photoStep',
                4: 'reviewStep'
            };
            return stepIds[step];
        }
        
        // ============================================
        // REVIEW & SUBMIT
        // ============================================
        function generateReview() {
            let reviewHtml = `
                <h3>Door Sales Summary</h3>
                <table style="width:100%; margin-bottom:20px; border-collapse:collapse;">
                    <tr style="background:var(--background-color);">
                        <th style="padding:8px; text-align:left;">Item</th>
                        <th style="padding:8px; text-align:center;">Qty</th>
                        <th style="padding:8px; text-align:right;">Total</th>
                    </tr>
            `;
            
            // Add door sales items
            Object.entries(occasionData.doorSales).forEach(([key, item]) => {
                if (item.quantity > 0) {
                    const itemName = PRICING.electronic[key]?.name || PRICING.paper[key]?.name || PRICING.misc[key]?.name || key;
                    reviewHtml += `
                        <tr>
                            <td style="padding:8px;">${itemName}</td>
                            <td style="padding:8px; text-align:center;">${item.quantity}</td>
                            <td style="padding:8px; text-align:right;">$${item.total.toFixed(2)}</td>
                        </tr>
                    `;
                }
            });
            
            reviewHtml += `
                    <tr style="background:var(--primary-color); color:white; font-weight:600;">
                        <td style="padding:8px;">Grand Total</td>
                        <td style="padding:8px; text-align:center;">${occasionData.totals.players} players</td>
                        <td style="padding:8px; text-align:right;">$${occasionData.totals.grand.toFixed(2)}</td>
                    </tr>
                </table>
                
                <h3>Pull Tab Summary</h3>
                <table style="width:100%; margin-bottom:20px; border-collapse:collapse;">
                    <tr style="background:var(--background-color);">
                        <th style="padding:8px; text-align:left;">Game</th>
                        <th style="padding:8px; text-align:right;">Gross</th>
                        <th style="padding:8px; text-align:right;">Prizes</th>
                        <th style="padding:8px; text-align:right;">Profit</th>
                    </tr>
            `;
            
            // Add pull tab games
            Object.values(occasionData.pullTabs).forEach(game => {
                if (game) {
                    const profit = game.grossSales - game.prizesPaid;
                    reviewHtml += `
                        <tr>
                            <td style="padding:8px;">${game.gameName}</td>
                            <td style="padding:8px; text-align:right;">$${game.grossSales.toFixed(2)}</td>
                            <td style="padding:8px; text-align:right;">$${game.prizesPaid.toFixed(2)}</td>
                            <td style="padding:8px; text-align:right;">$${profit.toFixed(2)}</td>
                        </tr>
                    `;
                }
            });
            
            reviewHtml += `
                </table>
                
                <h3>Document Photos</h3>
                <ul style="margin-bottom:20px;">
            `;
            
            const photoTypes = {
                'gamesSheet': 'Bingo Games Sheet',
                'occasionReport': 'Occasion Report',
                'moneySummary': 'Money Summary',
                'pullTabSummary': 'Pull Tab Summary',
                'depositSlip': 'Deposit Slip',
                'doorSalesPrint': 'Door Sales Printout'
            };
            
            Object.entries(photoTypes).forEach(([key, label]) => {
                const status = occasionData.photos[key] ? '‚úì Captured' : '‚ùå Missing';
                const style = occasionData.photos[key] ? 'color:var(--success-color);' : 'color:var(--error-color);';
                reviewHtml += `<li style="${style}">${label}: ${status}</li>`;
            });
            
            reviewHtml += `</ul>`;
            
            document.getElementById('reviewContent').innerHTML = reviewHtml;
        }
        
        function submitOccasion() {
            // Show loading
            document.getElementById('loadingOverlay').classList.add('active');
            document.getElementById('loadingText').textContent = 'Submitting occasion report...';
            
            // Here you would submit to your backend
            // For now, simulate submission
            setTimeout(() => {
                document.getElementById('loadingText').textContent = 'Upload complete!';
                setTimeout(() => {
                    document.getElementById('loadingOverlay').classList.remove('active');
                    alert('Occasion report submitted successfully!\n\nIt will be reviewed by an administrator.');
                    // Reset form or redirect
                    window.location.reload();
                }, 1500);
            }, 2000);
        }
        
        // ============================================
        // CUSTOM GAME WIZARD
        // ============================================
        function showCustomGameWizard(gameId) {
            // This would show a guided wizard for entering a new pull tab game
            // Following the structure from the catalog documentation
            const gameName = prompt('Enter the game name (e.g., "Lucky 7s 500"):');
            if (!gameName) return;
            
            const ticketCount = parseInt(prompt('Enter total ticket count:')) || 0;
            const pricePerTicket = parseFloat(prompt('Enter price per ticket ($):')) || 1;
            const totalPayout = parseFloat(prompt('Enter total prize payout ($):')) || 0;
            
            const grossSales = ticketCount * pricePerTicket;
            const idealProfit = grossSales - totalPayout;
            const profitPercent = (idealProfit / grossSales * 100).toFixed(1);
            
            // Add to occasion data
            occasionData.pullTabs[gameId] = {
                gameId: 'CUSTOM_' + Date.now(),
                gameName: gameName,
                formNumber: 'CUSTOM',
                ticketCount: ticketCount,
                pricePerTicket: pricePerTicket,
                grossSales: grossSales,
                prizesPaid: totalPayout,
                idealProfit: idealProfit,
                profitPercent: profitPercent
            };
            
            // Update display
            selectPullTabGame(gameId, 'CUSTOM_' + Date.now());
        }
    </script>
</body>
</html>
